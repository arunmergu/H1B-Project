5) Find the most popular top 10 job positions for H1B visa applications for each year?

select job_title,year from(select rank() over(partition by year order by ad desc)as ad1,job_title,year from(select count(job_title)as ad,job_title,year from h1b group by job_title,year)a)b where ad1<=10;


Output: 
PROGRAMMER ANALYST	2011
SOFTWARE ENGINEER	2011
COMPUTER PROGRAMMER	2011
SYSTEMS ANALYST	2011
BUSINESS ANALYST	2011
COMPUTER SYSTEMS ANALYST	2011
ASSISTANT PROFESSOR	2011
PHYSICAL THERAPIST	2011
SENIOR SOFTWARE ENGINEER	2011
SENIOR CONSULTANT	2011
PROGRAMMER ANALYST	2012
SOFTWARE ENGINEER	2012
COMPUTER PROGRAMMER	2012
SYSTEMS ANALYST	2012
BUSINESS ANALYST	2012
COMPUTER SYSTEMS ANALYST	2012
SOFTWARE DEVELOPER	2012
PHYSICAL THERAPIST	2012
ASSISTANT PROFESSOR	2012
SENIOR CONSULTANT	2012
PROGRAMMER ANALYST	2013
SOFTWARE ENGINEER	2013
COMPUTER PROGRAMMER	2013
SYSTEMS ANALYST	2013
TECHNOLOGY LEAD - US	2013
TECHNOLOGY ANALYST - US	2013
BUSINESS ANALYST	2013
COMPUTER SYSTEMS ANALYST	2013
SOFTWARE DEVELOPER	2013
SENIOR CONSULTANT	2013
PROGRAMMER ANALYST	2014
SOFTWARE ENGINEER	2014
COMPUTER PROGRAMMER	2014
SYSTEMS ANALYST	2014
SOFTWARE DEVELOPER	2014
BUSINESS ANALYST	2014
COMPUTER SYSTEMS ANALYST	2014
TECHNOLOGY LEAD - US	2014
TECHNOLOGY ANALYST - US	2014
SENIOR CONSULTANT	2014
PROGRAMMER ANALYST	2015
SOFTWARE ENGINEER	2015
COMPUTER PROGRAMMER	2015
SYSTEMS ANALYST	2015
SOFTWARE DEVELOPER	2015
BUSINESS ANALYST	2015
TECHNOLOGY LEAD - US	2015
COMPUTER SYSTEMS ANALYST	2015
TECHNOLOGY ANALYST - US	2015
SENIOR SOFTWARE ENGINEER	2015
PROGRAMMER ANALYST	2016
SOFTWARE ENGINEER	2016
SOFTWARE DEVELOPER	2016
SYSTEMS ANALYST	2016
COMPUTER PROGRAMMER	2016
BUSINESS ANALYST	2016
COMPUTER SYSTEMS ANALYST	2016
SENIOR SOFTWARE ENGINEER	2016
DEVELOPER	2016
TECHNOLOGY LEAD - US	2016

